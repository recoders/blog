---
title: 'PHPWord: не работает замена переменных'
author: mike
layout: post
categories:
  - Кодинг
tags:
  - php
  - кодинг
---
Решил я как-то делать отчеты в doc. Несколько минут гугления вывели меня на неплохую библиотечку: [PHPWord](http://phpword.codeplex.com/). Неплохая, с достаточным количеством примеров, но вот беда &#8211; не делает замену. Танцы с гуглом вокруг шаблона особого результата не давали: <a href="http://stackoverflow.com" class="autohyperlink" title="http://stackoverflow.com" target="_blank">stackoverflow.com</a> подсказывал непонятные глупости.

К счастью, методы терморектального дебага ещё никто не отменял. Поковыряв побайтно исходный документ, я обнаружил, что MS Word имеет пренеприятнейшую особенность: малейшее исправление в середине слова он обрамляет большим количеством служебных тегов. Конечно, это дает неслабую гибкость при создании документов, но мне это явно мешало. Но итогом всех этих действий стал алгоритм создания шаблона для PHPWord:

  1. Забыть на время о привычке ставить скобки, а затем возвращаться, чтобы установить их содержимое.  <span class="lang:default decode:true  crayon-inline ">${Value1}</span>
  2. Переменные для замены мы пишем по символам, слева направо.
  3. Если требуется что-то исправить: стираем все слово (в том числе и скобки и знак доллара) и пишем все заново.

Вот в общем-то и все. Если следовать этим простым правилам при создании шаблона, то PHPWord будет великолепно справляться со своей работой и радовать вас.