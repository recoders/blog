---
title: Белоснежка и семь вордпрессов
author: mike
layout: post
categories:
  - Кодинг
tags:
  - Wordpress
---
Вопрос, который я сегодня рассмотрю, уже не раз поднимался в [этих ваших интернетах](https://www.google.com/search?q=wordpress+multisite), 
но мы же на этом сайте занимаемся [изобретением велосипедов](http://lurkmore.to/%D0%92%D0%B5%D0%BB%D0%BE%D1%81%D0%B8%D0%BF%D0%B5%D0%B4) не так ли? 
Поэтому, раз уж мне представилась эта возможность &#8211; Постараюсь описать процесс максимально подробно и просто, несмотря на то, 
насколько полно описывались его отдельные части в других источниках.
Итак, речь пойдет об установке нескольких вордпрессов на одной базе. Задача, которая стала в последнее время весьма тривиальной, все еще хранит в себе подводные камни.

Итак у нас возможны два случая: когда мы добавляем в уже существующую базу новый вордпресс и когда мы сливаем несколько копий воедино.
Первый весьма тривиален и решается установкой свойств:
{% highlight php %}
define('CUSTOM_USER_TABLE', 'wp_users');
define('CUSTOM_USER_META_TABLE', 'wp_usermeta');
{% endhighlight %}

Второй же требует некоторой сноровки. Рассмотрим его подробнее. 

  * Скопируем содержимое второй базы в первую, изменив префикс при необходимости (последние версии phpMyAdmin позволяют сделать это из коробки). 
  * Если префикс не изменился, то просто прописываем в конфиг второго вордпресса 
    <pre>
define('CUSTOM_USER_TABLE', 'wp_users');
define('CUSTOM_USER_META_TABLE', 'wp_usermeta');
    </pre>
и добавляем недостающие строки в таблицу wp_users (они содержат права для второго блога) из таблицы users второго блога. 
  * Если меняется префикс, то в таблице wp\_users добавляем строчки, соответствующие правам юзера в новой базе с новым префиксом и (**внимание!**) 
в таблице wp\_users_meta добавляем строчку, которая будет определять нам эти права тоже с новым префиксом. 
Этот последний шаг часто опускается в руководствах и именно из-за него начинающий веб-мастер получает страницу

    Вы не имеете достаточно прав для доступа к данной странице. 

В вышеуказаной модификации такого бага &#8211; нет.

Надеюсь, что мой пост кому-нибудь да поможет =)
